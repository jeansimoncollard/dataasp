YUI.add("hermes-template-photo-note-read-mode",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return'<a href="/account/upgrade/pro" class="pro-badge-inline">PRO</a>'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'<div class="note-text" style="z-index:'+l((o=(o=n.z||(t!=null?t.z:t))!=null?o:a,typeof o===f?o.call(u,{name:"z",hash:{},data:i}):o))+';">\n	<div class="text-alignment-fix hyphenate" style="left:'+l((o=(o=n.x||(t!=null?t.x:t))!=null?o:a,typeof o===f?o.call(u,{name:"x",hash:{},data:i}):o))+"px;top:"+l((o=(o=n.y||(t!=null?t.y:t))!=null?o:a,typeof o===f?o.call(u,{name:"y",hash:{},data:i}):o))+'px">\n		<a href="'+l((o=(o=n.authorURL||(t!=null?t.authorURL:t))!=null?o:a,typeof o===f?o.call(u,{name:"authorURL",hash:{},data:i}):o))+'" class="author">'+l((o=(o=n.authorName||(t!=null?t.authorName:t))!=null?o:a,typeof o===f?o.call(u,{name:"authorName",hash:{},data:i}):o))+"</a>"+((s=n["if"].call(u,t!=null?t.authorIsPro:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+"<br>\n		"+l((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||a).call(u,t!=null?t.text:t,{name:"renderTrustedMarkup",hash:{},data:i}))+"\n	</div>\n</div>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-note-read-mode",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-note-write-mode",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return'<button class="delete-note danger tiny">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"common.DELETE"},data:i}))+"</button>"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'<div class="note-text adding" data-for-note-yuid="'+l((o=(o=n.noteYUID||(t!=null?t.noteYUID:t))!=null?o:a,typeof o===f?o.call(u,{name:"noteYUID",hash:{},data:i}):o))+'" style="z-index:'+l((o=(o=n.z||(t!=null?t.z:t))!=null?o:a,typeof o===f?o.call(u,{name:"z",hash:{},data:i}):o))+';">\n	<div class="text-alignment-fix hyphenate" style="left:'+l((o=(o=n.x||(t!=null?t.x:t))!=null?o:a,typeof o===f?o.call(u,{name:"x",hash:{},data:i}):o))+"px;top:"+l((o=(o=n.y||(t!=null?t.y:t))!=null?o:a,typeof o===f?o.call(u,{name:"y",hash:{},data:i}):o))+'px">\n		<textarea class="note-text-textarea" placeholder="'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADD_A_NOTE"},data:i}))+'">'+l((o=(o=n.text||(t!=null?t.text:t))!=null?o:a,typeof o===f?o.call(u,{name:"text",hash:{},data:i}):o))+'</textarea>\n		<div class="note-text-buttons">\n			<button class="save-note tiny">'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"common.SAVE"},data:i}))+'</button>\n			<button class="cancel-note alt tiny">'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"common.CANCEL"},data:i}))+"</button>"+((s=n["if"].call(u,t!=null?t.canDelete:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n		</div>\n	</div>\n</div>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-note-write-mode",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-note-drag-handles",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){return'<span class="note-drag-handle note-drag-handle-tl" data-drag-resize-direction="tl"></span><span class="note-drag-handle note-drag-handle-tr" data-drag-resize-direction="tr"></span><span class="note-drag-handle note-drag-handle-br" data-drag-resize-direction="br"></span><span class="note-drag-handle note-drag-handle-bl" data-drag-resize-direction="bl"></span>'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-note-drag-handles",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-notes-scrappy-view",function(e,t){function n(t){this.yuid=e.guid(),this.id=t.id,this.photoId=t.photoId,this.x=t.x,this.y=t.y,this.z=0,this.w=t.w,this.h=t.h,this.text=t.text,this.author=t.author,this.authorName=t.authorName,this.authorRealName=t.authorRealName,this.authorIsPro=t.authorIsPro,this.canEdit=t.canEdit,this.canDelete=t.canDelete,this.isStoredOnServer=t.isStoredOnServer}n.prototype.getScaled=function(e){return{x:this.x*e,y:this.y*e,w:this.w*e,h:this.h*e}};var r=20,i=1e3,s=1,o=100,u=2,a=8,f={idle:{begin:"beginIdle",end:"endIdle",events:{mousedown:"handleIdleMouseDown",mouseup:"handleIdleMouseUp",mouseenter:{handler:"handleIdleMouseEnter",delegate:".note"},mouseleave:{handler:"handleIdleMouseLeave",delegate:".note"}}},editing:{begin:"beginEditing",events:{mousedown:"handleEditingMouseDown",mouseup:"handleEditingMouseUp",keydown:"handleEditingKeyDown"}},dragging:{begin:"beginDragging",end:"endDragging",events:{mousemove:"handleDraggingMouseMove",mouseup:"handleDraggingMouseUp"}}};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.stateEventHandles=[],this},loadState:function(){var t=this,n;return n={photo:this.appContext.getModel("photo-models",this._params.photoId),photoNotes:this.appContext.getModel("photo-notes-models",this._params.photoId),noteModel:this.appContext.getModelRegistry("note-models")},this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid&&(n.viewer=this.appContext.getModel("person-models",this.appContext.getViewer().nsid)),(new e.FlickrPromise(n)).then(function(e){t.set("photoModel",e.photo),t.set("photoNotesModel",e.photoNotes),t.set("noteModel",e.noteModel),e.viewer&&t.set("viewer",e.viewer)})},buildContainer:function(){return this},activate:function(){var t=this.appContext.flipper.isFlipped("enable-scrappy-notes-deleting"),r=this.appContext.flipper.isFlipped("enable-scrappy-notes-editing"),s=this.get("photoModel"),o=s.getValue("owner"),u=o.getValue("id"),a=this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid,f=this.get("photoNotesModel"),l=f.getValue("notes").toJSON(),c,h,p,d;if(s.getValue("isVideo"))return this.deactivate(),this;this.box=this.get("container"),this.notes=[],this.canAddNotes=s.getValue("canAddMeta"),this.canAddNotes&&this.box.setStyle("pointerEvents","auto"),this.registerEventHandler(this.box.on("mouseenter",this.revealNotes.bind(this))),this.registerEventHandler(this.box.on("mouseleave",this.hideNotes.bind(this))),this.registerEventHandler(e.on("photo:entering-vr",this.deactivate.bind(this)));for(h=0;h<l.length;h++)c=l[h],p=r&&(a===u||a===c.author),d=t&&(a===u||a===c.author),this.notes.push(new n({id:c.id,photoId:s.getValue("id"),x:c.left,y:c.top,w:c.width,h:c.height,text:c.text,author:c.author,authorName:c.authorName,authorRealName:c.authorRealName,authorIsPro:c.authorIsPro,canEdit:p,canDelete:d,isStoredOnServer:!0}));return this.restackNotes(),this.syncWithPhoto(),this.renderNotes(),this.revealNotes(),this.pageLoadNotesFlashTimer=setTimeout(this.hideNotes.bind(this),i),this.enterState("idle"),this},onParentViewEvent:function(e,t){t&&t[0]==="photoWellResized"&&this.isActivated&&this.box&&(this.syncWithPhoto(),this.renderNotes())},enterState:function(e,t){var n;t=t||{};if(!f[e])return;while(this.stateEventHandles.length)this.stateEventHandles.pop().detach();this.currentState&&f[this.currentState].end&&this[f[this.currentState].end]&&this[f[this.currentState].end].call(this,t);for(var r in f[e].events)n=f[e].events[r],typeof n=="string"?this.stateEventHandles.push(this.box.on(r,this[n].bind(this))):typeof n=="object"&&(n.delegate?this.stateEventHandles.push(this.box.delegate(r,this[n.handler].bind(this),n.delegate)):this.stateEventHandles.push(this.box.on(r,this[n.handler].bind(this))));f[e].begin&&this[f[e].begin]&&this[f[e].begin].call(this,t),this.currentState=e},revealNotes:function(e){this.box.addClass("box-hovered"),clearTimeout(this.pageLoadNotesFlashTimer)},hideNotes:function(){this.box.removeClass("box-hovered"),this.hideHovered()},beginIdle:function(e){var t=e.element;this.box.removeClass("box-note-clicked"),delete this.draggingMemo,this.box.all(".note-text").remove(!0),t&&t.getDOMNode()&&t.removeClass("note-clicked"),e.rerender&&(this.restackNotes(),this.renderNotes())},endIdle:function(e){this.tempMouseMoveListener&&(this.tempMouseMoveListener.detach(),delete this.tempMouseMoveListener)},handleIdleMouseDown:function(t){var i,s,o,u,f=!1;if(t.button!==1||t.ctrlKey||t.metaKey)return;if(t.target.hasClass("note-text"))return;t.target.hasClass("note")&&(i=this.getNoteByID(t.target.getAttribute("data-note-yuid"))),i&&(i.canEdit||i.canDelete)?this.enterState("editing",{note:i,element:t.target}):(o={x:t.clientX,y:t.clientY},u=this.box.getXY(),this.canAddNotes&&(t.preventDefault(),this.tempMouseMoveListener=this.box.on("mousemove",function(t){var i,l,c,h,p;i=Math.sqrt(Math.pow(t.clientX-o.x,2)+Math.pow(t.clientY-o.y,2)),l="";if(i<r)return;f||(f=!0,this.box.addClass("doing-initial-drag")),l+=o.y-t.clientY>=0?"t":"b",l+=o.x-t.clientX>=0?"l":"r";switch(l){case"tl":h=0,p=0;break;case"tr":h=a,p=0;break;case"bl":h=0,p=a;break;case"br":h=a,p=a}c=this.get("viewer"),s=new n({id:e.guid(),photoId:this.get("photoModel").getValue("id"),x:(Math.min(o.x,t.clientX)-u[0]+window.pageXOffset)/this.ratio,y:(Math.min(o.y,t.clientY)-u[1]+window.pageYOffset)/this.ratio,w:Math.abs(o.x-t.clientX)/this.ratio-h,h:Math.abs(o.y-t.clientY)/this.ratio-p,text:"",author:c.getValue("nsid"),authorName:c.getValue("username"),authorRealName:c.getValue("displayname"),authorIsPro:c.getValue("isPro"),canEdit:!0,canDelete:!0,isStoredOnServer:!1}),this.notes.push(s),this.createNewNote(s),this.storeNoteBackup(s),s.node.append(this.templates("photo-note-drag-handles")()),this.box.addClass("box-note-clicked"),s.node.addClass("note-clicked"),s.node.addClass("note-can-edit"),this.enterState("dragging",{note
:s,element:s.node,dragMetadata:{type:"resize",startX:Math.min(o.x,t.clientX)+window.pageXOffset,startY:Math.min(o.y,t.clientY)+window.pageYOffset,dragHandle:s.node.one(".note-drag-handle-"+l),direction:l}})}.bind(this))))},handleIdleMouseUp:function(t){this.tempMouseMoveListener&&(this.tempMouseMoveListener.detach(),delete this.tempMouseMoveListener),t.target===this.box&&e.fire("photo:zoom",{x:t.pageX,y:t.pageY})},handleIdleMouseEnter:function(e){var t=e.target.ancestor(".note",!0),n=this.getNoteByID(t.getAttribute("data-note-yuid")),r=n.getScaled(this.ratio),i;this.delayedNoteMouseLeaveHandler&&(this.hideHovered(),clearTimeout(this.delayedNoteMouseLeaveHandler),delete this.delayedNoteMouseLeaveHandler),t.addClass("note-hovered"),t.insert(this.templates("photo-note-read-mode")({x:r.x,y:r.y+r.h+u,z:s,text:n.text.replace(/\n/g,"<br>"),authorName:n.authorRealName||n.authorName,authorURL:"/photos/"+n.author+"/",authorIsPro:n.authorIsPro}),"after"),i=this.box.one(".note-text"),i.on("mouseenter",function(e){this.delayedNoteMouseLeaveHandler&&(clearTimeout(this.delayedNoteMouseLeaveHandler),delete this.delayedNoteMouseLeaveHandler)}.bind(this)),i.on("mouseleave",this.handleIdleMouseLeave.bind(this))},handleIdleMouseLeave:function(e){this.delayedNoteMouseLeaveHandler=setTimeout(this.hideHovered.bind(this),o)},beginEditing:function(e){var t=e.note,n=e.element,r=t.getScaled(this.ratio);this.storeNoteBackup(t),this.hideHovered(),this.box.hasClass("box-note-clicked")||this.box.addClass("box-note-clicked"),n.hasClass("note-clicked")||n.addClass("note-clicked"),n.siblings(".note-text.adding").size()===0&&n.insert(this.templates("photo-note-write-mode")({noteYUID:t.yuid,x:r.x,y:r.y+r.h+u,z:s,text:t.text.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),canDelete:t.isStoredOnServer}),"after"),n.one(".note-drag-handle")||n.append(this.templates("photo-note-drag-handles")()),setTimeout(function(){this.box.one(".note-text[data-for-note-yuid="+t.yuid+"] textarea").focus()}.bind(this),10)},handleEditingMouseDown:function(e){var t,n,r;if(e.button!==1||e.ctrlKey||e.metaKey)return;n=e.target.ancestor(".note",!0);if(!n)return;t=this.getNoteByID(n.getAttribute("data-note-yuid"));if(!t)return;t.canEdit&&(e.target.hasClass("note-drag-handle")?r={type:"resize",startX:e.clientX+window.pageXOffset,startY:e.clientY+window.pageYOffset,dragHandle:e.target,direction:e.target.getAttribute("data-drag-resize-direction")}:e.target.hasClass("note-clicked")&&(r={type:"move",startX:e.clientX+window.pageXOffset,startY:e.clientY+window.pageYOffset,dragHandle:e.target}),r&&this.enterState("dragging",{note:t,element:n,dragMetadata:r}))},handleEditingMouseUp:function(e){e.target.test("button")&&this.performButtonAction(e)},handleEditingKeyDown:function(e){var t=this.box.one(".note-clicked"),n=this.getNoteByID(t.getAttribute("data-note-yuid"));switch(e.keyCode){case 8:(e.ctrlKey||e.metaKey)&&window.confirm(this.intlMessage({intlName:"photo-page-scrappy.CONFIRM_NOTE_DELETION"}))&&(this.deleteNote(n,t),e.preventDefault());break;case 13:if(e.ctrlKey||e.metaKey)this.saveNoteEdits(n,t),e.preventDefault();e.target.test("button")&&this.performButtonAction(e);break;case 27:this.cancelNoteEdits(n,t);break;case 32:e.target.test("button")&&this.performButtonAction(e)}},performButtonAction:function(e){var t=this.box.one(".note-clicked"),n=this.getNoteByID(t.getAttribute("data-note-yuid"));e.target.hasClass("save-note")?this.saveNoteEdits(n,t):e.target.hasClass("cancel-note")?this.cancelNoteEdits(n,t):e.target.hasClass("delete-note")&&window.confirm(this.intlMessage({intlName:"photo-page-scrappy.CONFIRM_NOTE_DELETION"}))&&this.deleteNote(n,t)},saveNoteEdits:function(e,t){var n=this.get("noteModel"),r=this;e.text=r.box.one(".note-text[data-for-note-yuid="+e.yuid+"] textarea").get("value").trim();if(!e.text)return;e.isStoredOnServer?(n.setValues(e.id,{left:e.x,top:e.y,width:e.w,height:e.h,text:e.text}),n.remoteUpdate(e.id).then(function(n){n&&(e.text=n.getValue("text")),r.deleteNoteBackup(),r.enterState("idle",{note:e,element:t,rerender:!0})},function(e){})):n.remoteCreate({photoId:e.photoId,left:e.x,top:e.y,width:e.w,height:e.h,text:e.text,author:e.author,authorName:e.authorName,authorRealName:e.authorRealName,authorIsPro:e.authorIsPro}).then(function(n){e.id=n.getValue("id"),e.text=n.getValue("text"),e.isStoredOnServer=!0,r.deleteNoteBackup(),r.enterState("idle",{note:e,element:t,rerender:!0})},function(e){})},cancelNoteEdits:function(e,t){var n;e.isStoredOnServer?(n=this.getNoteBackup(),e.w=n.w,e.h=n.h,e.x=n.x,e.y=n.y,this.positionNote(e)):(this.notes.pop(),this.box.one("[data-note-yuid="+e.yuid+"]").remove(!0),e=null,t=null),this.deleteNoteBackup(),this.enterState("idle",{note:e,element:t})},deleteNote:function(e,t){var n=this.get("noteModel"),r=this,i=!1,s;n.remoteDelete(e.id).then(function(n){t.remove(!0);for(s=r.notes.length-1;s>=0;s--)if(r.notes[s].id===e.id){i=!0;break}i&&r.notes.splice(s,1),r.deleteNoteBackup(),r.enterState("idle",{note:e,element:t})},function(e){})},beginDragging:function(t){this.draggingMemo=e.merge(t.dragMetadata,{note:t.note,noteAtStart:e.clone(t.note),element:t.element})},endDragging:function(e){this.box.removeClass("doing-initial-drag")},handleDraggingMouseMove:function(e){var t=19/this.ratio,n,r,i,s,o,u,a,f,l,c,h,p,d,v;n=this.draggingMemo.note,i=this.draggingMemo.startX-e.clientX-window.pageXOffset,s=this.draggingMemo.startY-e.clientY-window.pageYOffset,this.boxWidth>this.boxHeight?(d=500,v=500/(this.boxWidth/this.boxHeight)):(v=500,d=500/(this.boxHeight/this.boxWidth));if(this.draggingMemo.type==="resize"){r=this.draggingMemo.direction;switch(r){case"tl":o=i/this.ratio*-1,a=i/this.ratio,u=s/this.ratio*-1,f=s/this.ratio;break;case"tr":o=0,a=i/this.ratio*-1,u=s/this.ratio*-1,f=s/this.ratio;break;case"br":o=0,a=i/this.ratio*-1,u=0,f=s/this.ratio*-1;break;case"bl":o=i/this.ratio*-1,a=i/this.ratio,u=0,f=s/this.ratio*-1}l=this.draggingMemo.noteAtStart.x+o,h=this.draggingMemo.noteAtStart
.w+a,c=this.draggingMemo.noteAtStart.y+u,p=this.draggingMemo.noteAtStart.h+f,h<t&&(o&&(l=this.draggingMemo.noteAtStart.w+this.draggingMemo.noteAtStart.x-t),h=t),h+l>d&&(h=d-l),l<0&&(l=0,h=this.draggingMemo.noteAtStart.w+this.draggingMemo.noteAtStart.x),n.x=l,n.w=h,p<t&&(u&&(c=this.draggingMemo.noteAtStart.h+this.draggingMemo.noteAtStart.y-t),p=t),p+c>v&&(p=v-c),c<0&&(c=0,p=this.draggingMemo.noteAtStart.h+this.draggingMemo.noteAtStart.y),n.y=c,n.h=p}else this.draggingMemo.type==="move"&&(l=this.draggingMemo.noteAtStart.x-i/this.ratio,c=this.draggingMemo.noteAtStart.y-s/this.ratio,l<0&&(l=0),l+this.draggingMemo.noteAtStart.w>d&&(l=d-this.draggingMemo.noteAtStart.w),c<0&&(c=0),c+this.draggingMemo.noteAtStart.h>v&&(c=v-this.draggingMemo.noteAtStart.h),n.x=l,n.y=c);this.positionNote(n)},handleDraggingMouseUp:function(e){this.enterState("editing",{note:this.draggingMemo.note,element:this.draggingMemo.element})},storeNoteBackup:function(t){this.noteBeforeEdits||(this.noteBeforeEdits=e.clone(t))},getNoteBackup:function(){return this.noteBeforeEdits},deleteNoteBackup:function(){delete this.noteBeforeEdits},getNoteByID:function(e){return this.notes.find?this.notes.find(function(t){return t.yuid===e}):this.notes.filter(function(t){return t.yuid===e})[0]},renderNotes:function(){var t=this.getNoteBackup(),n,r;t&&(n=e.clone(t.node.getDOMNode())),this.box.all(".note").remove(!0),this.notes.forEach(this.createNewNote.bind(this)),t&&(r=this.box.one("[data-note-yuid="+t.yuid+"]"),r.set("className",n.className),t.node=r)},createNewNote:function(t){t.node=e.Node.create('<span class="note" data-note-yuid="'+t.yuid+'"></span>'),t.canEdit&&t.node.addClass("note-can-edit"),this.box.append(t.node),this.positionNote(t)},positionNote:function(e){var t=e.getScaled(this.ratio),n;e.node.setStyles({left:t.x+"px",top:t.y+"px",width:t.w+"px",height:t.h+"px",zIndex:e.z}),n=this.box.one(".note-text[data-for-note-yuid="+e.yuid+"]"),n&&(n.setStyle("z-index",s),n.one(".text-alignment-fix").setStyles({left:t.x+"px",top:t.y+t.h+u+"px"}))},restackNotes:function(){this.notes.sort(function(e,t){return t.w*t.h-e.w*e.h}).forEach(function(e){e.z=s++})},syncWithPhoto:function(){var t=e.one(".photo-well-media-scrappy-view").getDOMNode(),n=parseInt(getComputedStyle(t).paddingTop,10),r=parseInt(getComputedStyle(t).paddingBottom,10),i=t.offsetWidth,s=t.offsetHeight-n-r,o=t.offsetLeft,u=t.offsetTop+n;this.box.setStyles({width:i+"px",height:s+"px",left:o+"px",top:u+"px"}),this.ratio=Math.max(i,s)/500,this.boxWidth=i,this.boxHeight=s,this.boxLeft=o,this.boxTop=u},hideHovered:function(){this.box.all(".note-hovered").removeClass("note-hovered"),this.box.all(".note-text:not(.adding)").remove(!0)},deactivate:function(){this.get("container").setStyle("display","none").remove()}})},"@VERSION@",{requires:["hermes-template-photo-note-read-mode","hermes-template-photo-note-write-mode","hermes-template-photo-note-drag-handles","flickr-view"],optional:["photo-notes-models","photo-models"],langBundles:["common","photo-page-scrappy"]});
